// Copyright 2025 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto3";

package google.cloud.cloudsecuritycompliance.v1;

import "google/api/annotations.proto";
import "google/api/client.proto";
import "google/api/field_behavior.proto";
import "google/api/resource.proto";
import "google/cloud/cloudsecuritycompliance/v1/common.proto";
import "google/protobuf/empty.proto";
import "google/protobuf/field_mask.proto";

option csharp_namespace = "Google.Cloud.CloudSecurityCompliance.V1";
option go_package = "cloud.google.com/go/cloudsecuritycompliance/apiv1/cloudsecuritycompliancepb;cloudsecuritycompliancepb";
option java_multiple_files = true;
option java_outer_classname = "ConfigProto";
option java_package = "com.google.cloud.cloudsecuritycompliance.v1";
option php_namespace = "Google\\Cloud\\CloudSecurityCompliance\\V1";
option ruby_package = "Google::Cloud::CloudSecurityCompliance::V1";

// Config Service manages compliance frameworks, cloud controls, and their
// configurations.
service Config {
  option (google.api.default_host) = "cloudsecuritycompliance.googleapis.com";
  option (google.api.oauth_scopes) =
      "https://www.googleapis.com/auth/cloud-platform";

  // Lists all Frameworks (both Built-in and Custom) available within a given
  // parent resource. This method supports pagination.
  // The latest major version of each Framework is returned.
  rpc ListFrameworks(ListFrameworksRequest) returns (ListFrameworksResponse) {
    option (google.api.http) = {
      get: "/v1/{parent=organizations/*/locations/*}/frameworks"
    };
    option (google.api.method_signature) = "parent";
  }

  // Gets details of a single Framework.
  // This method retrieves a Framework resource, which can be either Built-in or
  // Custom, identified by its name.
  //
  // By default, the latest major version of the Framework is returned.
  // A specific major version can be retrieved by specifying the
  // `major_revision_id` in the request.
  rpc GetFramework(GetFrameworkRequest) returns (Framework) {
    option (google.api.http) = {
      get: "/v1/{name=organizations/*/locations/*/frameworks/*}"
    };
    option (google.api.method_signature) = "name";
  }

  // Creates a new Framework with type `Custom` under a given parent resource.
  // Frameworks with type `Built-in` are managed by Google and cannot be created
  // through this API.
  rpc CreateFramework(CreateFrameworkRequest) returns (Framework) {
    option (google.api.http) = {
      post: "/v1/{parent=organizations/*/locations/*}/frameworks"
      body: "framework"
    };
    option (google.api.method_signature) = "parent,framework,framework_id";
  }

  // Updates a single Framework.
  // This method allows for partial updates of a Framework resource. The fields
  // to be updated are specified using the `update_mask`.
  //
  // - If an `update_mask` is provided, only the fields specified in the mask
  // will be updated.
  // - If no `update_mask` is provided, all fields present in the request's
  // `framework` body will be used to overwrite the existing resource.
  //
  // This operation can only be performed on Frameworks with type `CUSTOM`.
  // A successful update will result in a new version of the Framework.
  rpc UpdateFramework(UpdateFrameworkRequest) returns (Framework) {
    option (google.api.http) = {
      patch: "/v1/{framework.name=organizations/*/locations/*/frameworks/*}"
      body: "framework"
    };
    option (google.api.method_signature) = "framework,update_mask";
  }

  // Deletes a single Custom Framework, including all its minor and
  // minor revisions.
  //
  // - This operation can only be performed on Frameworks with type `CUSTOM`.
  //   Built-in Frameworks cannot be deleted.
  // - The Framework cannot be deleted if it is currently deployed on any
  //   resource.
  // - This action is permanent and cannot be undone.
  rpc DeleteFramework(DeleteFrameworkRequest) returns (google.protobuf.Empty) {
    option (google.api.http) = {
      delete: "/v1/{name=organizations/*/locations/*/frameworks/*}"
    };
    option (google.api.method_signature) = "name";
  }

  // Lists all CloudControls (both Built-in and Custom) available within a given
  // parent resource. This method supports pagination.
  // The latest major version of each CloudControl is returned.
  rpc ListCloudControls(ListCloudControlsRequest)
      returns (ListCloudControlsResponse) {
    option (google.api.http) = {
      get: "/v1/{parent=organizations/*/locations/*}/cloudControls"
    };
    option (google.api.method_signature) = "parent";
  }

  // Gets details of a single CloudControl.
  // This method retrieves a CloudControl resource, which can be either Built-in
  // or Custom, identified by its name.
  //
  // By default, the latest major version of the CloudControl is returned.
  // A specific major version can be retrieved by specifying the
  // `major_revision_id` in the request.
  rpc GetCloudControl(GetCloudControlRequest) returns (CloudControl) {
    option (google.api.http) = {
      get: "/v1/{name=organizations/*/locations/*/cloudControls/*}"
    };
    option (google.api.method_signature) = "name";
  }

  // Creates a new CloudControl with type `Custom` under a given parent
  // resource. `Built-in` CloudControls are managed by Google and cannot be
  // created through this API.
  rpc CreateCloudControl(CreateCloudControlRequest) returns (CloudControl) {
    option (google.api.http) = {
      post: "/v1/{parent=organizations/*/locations/*}/cloudControls"
      body: "cloud_control"
    };
    option (google.api.method_signature) =
        "parent,cloud_control,cloud_control_id";
  }

  // Updates a single CloudControl.
  // This method allows for partial updates of a Custom CloudControl resource.
  // Built-in CloudControls cannot be updated.
  //
  // - If an `update_mask` is provided, only the fields specified in the mask
  // will be updated.
  // - If no `update_mask` is provided, all fields present in the request's
  // `cloud_control` body will be used to overwrite the existing resource.
  //
  // A successful update will result in a new version of the CloudControl.
  rpc UpdateCloudControl(UpdateCloudControlRequest) returns (CloudControl) {
    option (google.api.http) = {
      patch: "/v1/{cloud_control.name=organizations/*/locations/*/cloudControls/*}"
      body: "cloud_control"
    };
    option (google.api.method_signature) = "cloud_control,update_mask";
  }

  // Deletes a single Custom CloudControl, including all its
  // major and minor revisions.
  //
  // - This operation can only be performed on CloudControls with type `CUSTOM`.
  //   Built-in CloudControls cannot be deleted.
  // - The CloudControl cannot be deleted if any of its revisions are currently
  //   referenced by any Framework.
  // - This action is permanent and cannot be undone.
  rpc DeleteCloudControl(DeleteCloudControlRequest)
      returns (google.protobuf.Empty) {
    option (google.api.http) = {
      delete: "/v1/{name=organizations/*/locations/*/cloudControls/*}"
    };
    option (google.api.method_signature) = "name";
  }
}

// Request message for listing Frameworks.
message ListFrameworksRequest {
  // Required. The parent resource name, in the format
  // `organizations/{organization}/locations/{location}`.
  // Only global location is supported.
  string parent = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {
      child_type: "cloudsecuritycompliance.googleapis.com/Framework"
    }
  ];

  // Optional. The maximum number of frameworks to return. The default value is
  // `500`.
  //
  // If you exceed the maximum value of `1000`, then the service uses the
  // maximum value.
  int32 page_size = 2 [(google.api.field_behavior) = OPTIONAL];

  // Optional. A pagination token returned from a previous request to list
  // frameworks. Provide this token to retrieve the next page of results.
  string page_token = 3 [(google.api.field_behavior) = OPTIONAL];
}

// Response message for listing Frameworks.
// Contains a paginated list of Framework resources.
message ListFrameworksResponse {
  // The list of Framework resources.
  repeated Framework frameworks = 1;

  // A pagination token. To retrieve the next page of results, call the method
  // again with this token.
  string next_page_token = 2;
}

// Request message for getting a Framework.
message GetFrameworkRequest {
  // Required. The name of the framework to retrieve.
  // Format:
  // organizations/{organization}/locations/{location}/frameworks/{framework_id}
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {
      type: "cloudsecuritycompliance.googleapis.com/Framework"
    }
  ];

  // Optional. The Framework major version to retrieve. If not specified, the
  // most recently updated revision_id is retrieved.
  int64 major_revision_id = 2 [(google.api.field_behavior) = OPTIONAL];
}

// Request message for creating a Framework
message CreateFrameworkRequest {
  // Required. The parent resource name, in the format
  // `organizations/{organization}/locations/{location}`.
  string parent = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {
      child_type: "cloudsecuritycompliance.googleapis.com/Framework"
    }
  ];

  // Required. ID of the framework.
  // This is not the full name of the framework.
  // This is the last part of the full name of the framework.
  string framework_id = 2 [(google.api.field_behavior) = REQUIRED];

  // Required. The resource being created
  Framework framework = 3 [(google.api.field_behavior) = REQUIRED];
}

// Request message for updating a Framework.
message UpdateFrameworkRequest {
  // Optional. Field mask is used to specify the fields to be overwritten in the
  // Framework resource by the update.
  // The fields specified in the update_mask are relative to the resource, not
  // the full request. A field will be overwritten if it is in the mask. If the
  // user does not provide a mask then all fields present in the request will be
  // overwritten.
  google.protobuf.FieldMask update_mask = 1
      [(google.api.field_behavior) = OPTIONAL];

  // Required. The resource being updated
  Framework framework = 2 [(google.api.field_behavior) = REQUIRED];

  // Optional. The major version ID of the framework to update.
  int64 major_revision_id = 3 [(google.api.field_behavior) = OPTIONAL];
}

// Request message for deleting a Framework.
message DeleteFrameworkRequest {
  // Required. Name of the resource, in the format
  // `organizations/{organization}/locations/{location}/frameworks/{framework}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {
      type: "cloudsecuritycompliance.googleapis.com/Framework"
    }
  ];
}

// Request message for listing CloudControls.
message ListCloudControlsRequest {
  // Required. The parent resource name, in the format
  // `organizations/{organization}/locations/{location}`.
  string parent = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {
      child_type: "cloudsecuritycompliance.googleapis.com/CloudControl"
    }
  ];

  // Optional. The maximum number of CloudControls to return. The default value
  // is `500`.
  //
  // If you exceed the maximum value of `1000`, then the service uses the
  // maximum value.
  int32 page_size = 2 [(google.api.field_behavior) = OPTIONAL];

  // Optional. A pagination token returned from a previous request to list
  // CloudControls. Provide this token to retrieve the next page of results.
  //
  // When paginating, parent provided to
  // ListCloudControls request must match the call that provided the page
  // token.
  string page_token = 3 [(google.api.field_behavior) = OPTIONAL];
}

// Response message for ListCloudControls.
message ListCloudControlsResponse {
  // The list of CloudControl resources.
  repeated CloudControl cloud_controls = 1;

  // A pagination token. To retrieve the next page of results, call the method
  // again with this token.
  string next_page_token = 2;
}

// Request message for getting a CloudControl.
message GetCloudControlRequest {
  // Required. The name of the cloudcontrol to retrieve in the format:
  // organizations/{organization}/locations/{location}/cloudControls/{cloud_control}
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {
      type: "cloudsecuritycompliance.googleapis.com/CloudControl"
    }
  ];
}

// Request message for creating a CloudControl
message CreateCloudControlRequest {
  // Required. The parent resource name, in the format
  // `organizations/{organization}/locations/{location}`.
  string parent = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {
      child_type: "cloudsecuritycompliance.googleapis.com/CloudControl"
    }
  ];

  // Required. ID of the CloudControl.
  // This is the last segment of the CloudControl resource name.
  // Format: `^[a-zA-Z][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]$`.
  string cloud_control_id = 2 [(google.api.field_behavior) = REQUIRED];

  // Required. The resource being created
  CloudControl cloud_control = 3 [(google.api.field_behavior) = REQUIRED];
}

// Request message for UpdateCloudControl.
message UpdateCloudControlRequest {
  // Optional. Field mask is used to specify the fields to be overwritten in the
  // CloudControl resource by the update.
  // The fields specified in the update_mask are relative to the resource, not
  // the full request. A field will be overwritten if it is in the mask. If the
  // user does not provide a mask then all fields present in the request will be
  // overwritten. The fields that can be updated are:
  // 1. Display_name
  // 2. Description
  // 3. Parameters
  // 4. Rules
  // 5. ParameterSpec.
  google.protobuf.FieldMask update_mask = 1
      [(google.api.field_behavior) = OPTIONAL];

  // Required. The resource being updated
  CloudControl cloud_control = 2 [(google.api.field_behavior) = REQUIRED];
}

// Request message for deleting a CloudControl.
message DeleteCloudControlRequest {
  // Required. Name of the resource, in the format
  // `organizations/{organization}/locations/{location}/CloudControls/{CloudControl}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {
      type: "cloudsecuritycompliance.googleapis.com/CloudControl"
    }
  ];
}
